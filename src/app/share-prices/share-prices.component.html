<div class="container-fluid" *ngIf="data">

  <h1>{{data?.name}}</h1>
  <h1>{{data?.code}}</h1>
  <h1>{{data?.price}}</h1>

  <!-- <ng-container *ngIf="data?.rows"> -->
  <div class="row flex-xl-nowrap mt-3">
    <div class="col-12 col-lg-9" style="border-right: 1px solid rgba(0, 0, 0, 0.1)">

      <table class="table">
        <thead class="bg-light">
          <tr>
            <th>CTCK</th>
            <th>Khuyến nghị</th>
            <th>Target</th>
            <th>Doanh thu</th>
            <th>LNTT</th>
            <th>LNST</th>
            <th>date</th>
          </tr>
        </thead>

        <tbody>
          <ng-container *ngIf="data?.recommended; else noDataRecommended">
            <ng-container *ngFor="let row of data?.recommended">
              <tr class="bg-light">
                <td>
                  {{row.companyRecommendations}}
                </td>
                <td>
                  {{row.companyRecommendationsAction}}
                </td>
                <td>
                  {{row.targetPrice}}
                </td>
                <td>
                  {{row.revenue}}
                </td>
                <td>
                  {{row.pretaxProfit}}
                </td>
                <td>
                  {{row.netProfit}}
                </td>
                <td>
                  {{row.timeRecommendations}}
                </td>
              </tr>
            </ng-container>
          </ng-container>
          <ng-template #noDataRecommended>
            Không có data
          </ng-template>
        </tbody>
      </table>

      <div class="row">
        <label for="inputEmail3" class="col-sm-3 col-form-label">Thời gian (*)</label>
        <div class="col-sm-9">
          <ng-container *ngFor="let item of otherFactors.filterTimes">
            <div class="form-check form-check-inline filter-width">
              <input class="form-check-input" type="radio" name="filterTime" id="{{item.code}}" [value]="item.code" [checked]="item.isSelected"
                (change)="selectFilterTime(item)">
              <label class="form-check-label" for="{{item.code}}">
                {{item.value}}
              </label>
            </div>
          </ng-container>
        </div>
      </div>

      <table class="table">
        <thead class="bg-light">
          <tr>
            <ng-container *ngFor="let item of data.headers; let idx = index">
              <ng-container *ngIf="idx == 0; else otherHeader">
                <th>
                  {{item}}
                </th>
                <th>
                </th>
              </ng-container>
              <ng-template #otherHeader>
                <th>
                  {{item}}
                </th>
              </ng-template>
            </ng-container>
          </tr>
        </thead>

        <tbody>
          <ng-container *ngFor="let row of data.rows;">
            <ng-container *ngIf="row.length == 1; else otherRow">
              <tr class="bg-light">
                <td colspan="7">
                  {{row[0]}}
                </td>
              </tr>
            </ng-container>
            <ng-template #otherRow>
              <tr [ngbPopover]="popContent" triggers="manual" (mouseenter)="showColumnCharts(p1, row)" (mouseleave)="closeColumnCharts(p1)"
                #p1="ngbPopover" placement="right">
                <ng-container *ngFor="let item of row; let idx = index">
                  <td>{{item}}</td>
                </ng-container>
              </tr>
            </ng-template>
          </ng-container>
        </tbody>
      </table>
    </div>
    <div class="col-12 col-lg-3">
      <table class="table">
        <thead class="bg-light">
          <tr>
            <th>Kế hoặc 2018</th>
          </tr>
        </thead>

        <tbody>
          <ng-container *ngIf="data?.plans; else noDataPlan">
            <ng-container *ngFor="let row of data?.plans">
              <tr class="bg-light">
                <td>
                  {{row[0]}}
                </td>
                <td>
                  {{row[1]}}
                </td>
              </tr>
            </ng-container>
          </ng-container>
          <ng-template #noDataPlan>
            Không có data
          </ng-template>

        </tbody>
      </table>

      <ng-template #popContent let-greeting="greeting">
        <canvas baseChart [datasets]="barChartData" [labels]="barChartLabels" [options]="barChartOptions" [legend]="barChartLegend"
          [colors]="barChartColors" [chartType]="barChartType" (chartHover)="chartHovered($event)" (chartClick)="chartClicked($event)"></canvas>
      </ng-template>
    </div>
  </div>
  <!-- </ng-container> -->
</div>
