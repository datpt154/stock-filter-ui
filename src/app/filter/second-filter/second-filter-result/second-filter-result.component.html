<mat-table #sort [dataSource]="dataSource" matSort>

  <ng-container matColumnDef="rowIndex">
    <mat-header-cell *matHeaderCellDef [ngClass]="'customNoClass'"> No. </mat-header-cell>
    <mat-cell *matCellDef="let element; let idx= index" [ngClass]="'customNoClass'"> {{idx + 1}} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="companyCode">
    <mat-header-cell *matHeaderCellDef mat-sort-header> Mã chứng khoán </mat-header-cell>
    <mat-cell *matCellDef="let element; let i=index">
      {{element.companyCode}} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="price">
    <mat-header-cell *matHeaderCellDef> Giá </mat-header-cell>
    <mat-cell *matCellDef="let element; let i=index" [ngbPopover]="popContent" triggers="manual" #p1="ngbPopover"
      placement="right" (mouseenter)="showColumnCharts(p1, 'price')" (mouseleave)="closeColumnCharts(p1)">
      {{element.price}}
    </mat-cell>
  </ng-container>

  <!-- <tr [ngbPopover]="popContent" triggers="manual" (mouseenter)="showColumnCharts(p1, row)" (mouseleave)="closeColumnCharts(p1)"
  #p1="ngbPopover" placement="top"> -->

  <!-- dynamic Columns -->
  <ng-container *ngFor="let dynamicColumn of selectedDataItems; let idx = index">
    <ng-container [matColumnDef]="dynamicColumn.code">
      <mat-header-cell *matHeaderCellDef> {{dynamicColumn.title}} </mat-header-cell>
      <mat-cell *matCellDef="let element; let i=index" [ngbPopover]="popContent" triggers="manual" #p1="ngbPopover"
        placement="right" (mouseenter)="showColumnCharts(p1, dynamicColumn.code)" (mouseleave)="closeColumnCharts(p1)">
        {{element.searchItems[idx].value}} </mat-cell>
    </ng-container>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row *matRowDef="let row; columns: displayedColumns; let colIndex = index"></mat-row>
</mat-table>

<mat-paginator #paginator [pageSize]="10" [pageSizeOptions]="[10, 20, 50]" [showFirstLastButtons]="true">
</mat-paginator>

<button type="button" class="btn btn-dark mb-3 float-right" (click)="backToFilterInput()">Back</button>

<ng-template #popContent let-greeting="greeting">
  <canvas baseChart width="480px" height="300px" [datasets]="barChartData" [labels]="barChartLabels" [options]="barChartOptions"
    [legend]="barChartLegend" [colors]="barChartColors" [chartType]="barChartType" (chartHover)="chartHovered($event)"
    (chartClick)="chartClicked($event)"></canvas>
</ng-template>
